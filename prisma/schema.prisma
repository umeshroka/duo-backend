generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider  = "postgresql"
    url       = env("DATABASE_URL")
    directUrl = env("DIRECT_URL")
}

model User {
    id             String   @id @default(uuid())
    email          String   @unique
    hashedPassword String
    firstName      String?
    lastName       String?
    phoneNumber    String?
    createdAt      DateTime @default(now())

    aiArtworks AiArtwork[]
    enquiries  Enquiry[]
}

model Artist {
    id          String   @id @default(uuid())
    name        String
    bio         String   @db.Text
    about       String   @db.Text
    nationality String
    birthYear   Int?
    deathYear   Int?
    isFeatured  Boolean @default(false)
    createdAt   DateTime @default(now())

    artworks      Artwork[]
    mediaArticles MediaArticle[]
}

model MediaArticle {
    id        String    @id @default(uuid())
    title     String?
    source    String?
    url       String?
    imageUrl  String?
    content   String?   @db.Text
    date      DateTime?
    artistId  String
    artist    Artist    @relation(fields: [artistId], references: [id])
    createdAt DateTime  @default(now())
}

enum ArtworkMedium {
    Paper   
    Silk
    Redpaper
}

enum ArtworkCategory {
    Painting
    Calligraphy
}

enum MountingMethod {
    Scroll
    Frame
    Board
    Unmounted
}

model Artwork {
    id              String           @id @default(uuid())
    title           String
    description     String?          @db.Text
    longDescription String?          @db.Text
    imageUrl        String
    medium          ArtworkMedium?
    category        ArtworkCategory?
    mounting        MountingMethod?
    heightCm        Float?
    widthCm         Float?
    year            Int?
    price           Float? // null if not for sale
    isFeatured      Boolean          @default(false)
    createdAt       DateTime         @default(now())

    artistId String
    artist   Artist @relation(fields: [artistId], references: [id])

    additionalTags String[]
    enquiries       Enquiry[]
}

model Editorial {
    id          String   @id @default(uuid())
    title       String
    content     String   @db.Text
    imageUrl    String
    author      String
    publishedAt DateTime @default(now())
    createdAt   DateTime @default(now())

    tags String[]
}

enum MasterclassType {
    INDIVIDUAL
    GROUP
    CORPORATE
}

model Masterclass {
    id          String          @id @default(uuid())
    title       String
    description String          @db.Text
    imageUrl    String?
    type        MasterclassType
    createdAt   DateTime        @default(now())
    enquiries   Enquiry[]
}

enum ServiceType {
    COMMISSION
    CONSULTATION
    AUTHENTICATION
    APPRAISAL
    RESTORATION
}

model Service {
    id          String      @id @default(uuid())
    title       String
    description String      @db.Text
    imageUrl    String?
    type        ServiceType
    createdAt   DateTime    @default(now())
    enquiries   Enquiry[]
}

enum EnquiryType {
    SERVICE
    MASTERCLASS
    ARTWORK
}

model Enquiry {
    id              String           @id @default(uuid())
    userId          String
    user            User             @relation(fields: [userId], references: [id])
    subject         String
    message         String           @db.Text
    enquiryType     EnquiryType

    serviceId       String?
    service         Service?         @relation(fields: [serviceId], references: [id])

    masterclassId   String?
    masterclass     Masterclass?     @relation(fields: [masterclassId], references: [id])
    
    artworkId       String?
    artwork         Artwork?         @relation(fields: [artworkId], references: [id])

    createdAt       DateTime         @default(now())
}

enum ArtworkType {
    CALLIGRAPHY_ONLY
    PAINTING_ONLY
    PAINTING_WITH_CALLIGRAPHY
}

model AiArtwork {
    id     String @id @default(uuid())
    userId String
    user   User   @relation(fields: [userId], references: [id])
    artworkType ArtworkType
    subjectPrompt String @db.Text

    calligraphyStyle String?
    paintingStyle    String?
    dynasty          String?
    technique        String?

    fullPrompt String   @db.Text
    imageUrl   String
    createdAt  DateTime @default(now())
}


